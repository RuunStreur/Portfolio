---
title: "Portfolio Computational Musicology 2022 - Ruun Streur"
output: 
  flexdashboard::flex_dashboard:
    storyboard: true
    orientation: column
    vertical_layout: fill
    self_contained: false
    theme: 
      version: 4
      bootswatch: minty
---

```{r setup, include=FALSE}
# Setupp
library(flexdashboard)
library(ggplot2)
library(plotly)
library(tidyverse)
library(spotifyr)
library(compmus)
library(gridExtra)
library(patchwork)
library(knitr)
library(kableExtra)
library(scales)
```


```{r}
# Loading Playlists and songs
bowie <- get_playlist_audio_features("", "109zncLRngc5ofl1DsCHcE")
bowie_eno <- get_playlist_audio_features("", "6Rb67d7vVnq1FFAASwy5p5")
TH <- get_playlist_audio_features("", "1K27mtJcCFQw4IxJLZlmNQ")
TH_eno <- get_playlist_audio_features("", "4XrUACEdnQh8WfygAgSKxd")
bowie_disc <- get_playlist_audio_features("", "0mkz40ZahTeC6y2klc527h")

bowie_extracol <- bowie %>% add_column(is_eno = 0)
bowie_eno_extracol <- bowie_eno %>% add_column(is_eno = 1)
TH_extracol <- TH %>% add_column(is_eno = 0)
TH_eno_extracol <- TH_eno %>% add_column(is_eno = 1)
bowie_all <- bind_rows(bowie_extracol, bowie_eno_extracol)
TH_all <- bind_rows(TH_extracol, TH_eno_extracol)

cap <- get_tidy_audio_analysis("0yhwdmbgkKdE1plV8xWdrd") 
heroes <- get_tidy_audio_analysis("5Ci3b8pfpLA9Zk17qGXBCF")
bop <- get_tidy_audio_analysis("4eBCTzBsSjYgrLH5clQf2x")
sans <- get_tidy_audio_analysis("58uyNQ2aC329uLMZpU9Ptz")
fela <- get_tidy_audio_analysis("0Q4O6v2akT3RfkNxCt522f")
nf <- get_tidy_audio_analysis("2pmytOddxLVaASHQqTH9LO")
aypt <- get_tidy_audio_analysis("7Js4OF5MUb2bqJe09g4uQE")
ata <- get_tidy_audio_analysis("37CRPk0L5ZpfPeePEPwE0t")


song0 <-
  nf %>%
  compmus_align(bars, segments) %>%
  select(bars) %>%
  unnest(bars) %>%
  mutate(
    pitches =
      map(segments,
          compmus_summarise, pitches,
          method = "rms", norm = "euclidean"
      )
  ) %>%
  mutate(
    timbre =
      map(segments,
          compmus_summarise, timbre,
          method = "rms", norm = "euclidean"
      )
  )

```



```{r} 
# Plotting
limy_min <- 0
limy_max <- 385000

bowieSum <- bowie%>%
  group_by(track.album.name)%>%
  summarize(meanDance=mean(danceability), meanVal = mean(valence), meanTempo = mean(tempo), meanAc = mean(acousticness), meanInst = mean(instrumentalness),
            meanPop = mean(track.popularity), meanDur = mean(track.duration_ms)
            )

bowie_enoSum <- bowie_eno%>%
  group_by(track.album.name)%>%
  summarize(meanDance=mean(danceability), meanVal = mean(valence), meanTempo = mean(tempo), meanAc = mean(acousticness), meanInst = mean(instrumentalness),
            meanPop = mean(track.popularity), meanDur = mean(track.duration_ms)
            )

talkingSum <- TH%>%
  group_by(track.album.name)%>%
  summarize(meanDance=mean(danceability), meanVal = mean(valence), meanTempo = mean(tempo), meanAc = mean(acousticness), meanInst = mean(instrumentalness),
            meanPop = mean(track.popularity), meanDur = mean(track.duration_ms)
                        )

talking_enoSum <- TH_eno%>%
  group_by(track.album.name)%>%
  summarize(meanDance=mean(danceability), meanVal = mean(valence), meanTempo = mean(tempo), meanAc = mean(acousticness), meanInst = mean(instrumentalness),
            meanPop = mean(track.popularity), meanDur = mean(track.duration_ms)
                        )

############################################################################################################################################################

bowieplot <- ggplot(bowieSum, aes(track.album.name, meanDur, color=track.album.name, fill=track.album.name)) + geom_col() + ylim(limy_min, limy_max) + 
  theme_light() +
  theme(axis.text.x=element_blank(),
        axis.ticks.x=element_blank()) +
  labs(
    title = "The mean duration in in four non-Eno produced Bowie Albums",
    x='Album',
    y= 'Duration in ms'
  )

bowie_enoplot <- ggplot(bowie_enoSum, aes(track.album.name, meanDur, color=track.album.name, fill=track.album.name)) + geom_col() + ylim(limy_min, limy_max) + 
  theme_light() +
  theme(axis.text.x=element_blank(),
        axis.ticks.x=element_blank())+
labs(
  title = "The mean duration in in Bowie's Berlin Trilogy",
  x='Album',
  y= 'Duration in ms'
)

talkingplot <- ggplot(talkingSum, aes(track.album.name, meanDur, color=track.album.name, fill=track.album.name)) + geom_col() + ylim(limy_min, limy_max) + 
  theme_light() +
  theme(axis.text.x=element_blank(),
        axis.ticks.x=element_blank())+
  labs(
    title = "The mean duration in three non-Eno produced Talking Heads albums",
    x='Album',
    y= 'Duration in ms'
  )

talking_enoplot <- ggplot(talking_enoSum, aes(track.album.name, meanDur, color=track.album.name, fill=track.album.name)) + geom_col()+ ylim(limy_min, limy_max) + 
  theme_light() +
  theme(axis.text.x=element_blank(),
        axis.ticks.x=element_blank())+
  labs(
    title = "The mean duration in three Eno produced Talking Heads albums",
    x='Album',
    y= 'Duration in ms'
  )
```

```{r}

bowie_discSum <- bowie_disc%>%
  group_by(track.album.name)%>%
  summarize(meanDance=mean(danceability), meanVal = mean(valence))

bowie_discplot <- ggplot(bowie_discSum, aes(x=reorder(track.album.name, meanDance), meanDance, color=track.album.name, fill=track.album.name)) + geom_col() + 
  theme_light() +
  theme(axis.text.x=element_blank(),
        axis.ticks.x=element_blank()) +
  labs(
    title = "The mean danceability in all of Bowie's albums",
    x='Album',
    y= 'Mean danceability'
  )

bowie_lollipop <- ggplot(bowie_discSum, aes(x=reorder(track.album.name, meanDance), y=meanDance), fill = track.album.name) + theme_light() +
  geom_point(size=3, aes(color = track.album.name)) + 
  geom_segment(aes(x=track.album.name, 
                   xend=track.album.name, 
                   y=0, 
                   yend=meanDance
                   )) + 
  xlab('Albums') + 
  ylab('Average Danceability') +
  labs(title="Bowie's biggest swingers", 
       subtitle="Average Danceability for every bowie album", 
       caption="source: Spotify API") + 
  theme( 
        axis.text.x = element_text(angle=80, vjust=0.5, size=6),
        axis.ticks.x = element_blank()) +
  xlab('Albums') + ylab('Mean Danceability')
  
############

bowie_all$duration_z <- round((bowie_all$track.duration_ms - mean(bowie_all$track.duration_ms))/sd(bowie_all$track.duration_ms), 2) 
bowie_all$is_eno2 <- ifelse(bowie_all$is_eno < 1, "No", "Yes")  # above / below avg flag
bowie_all <- bowie_all[order(bowie_all$duration_z), ]
bowie_all$track.name <- factor(bowie_all$track.name, levels = bowie_all$track.name)  # convert to factor to retain sorted order in plot.

divbar1 <- ggplot(bowie_all, aes(x=track.name, y=duration_z)) + 
  geom_bar(stat='identity', aes(fill=is_eno2), width=.5)  +
  scale_fill_manual(name="Produced by Eno", 
                    labels = c("Produced by Eno", "Not Produced by Eno"), 
                    values = c("Yes"="#00ba38", "No"="#f8766d")) + 
  labs(subtitle="Normalised duration of Bowie's songs", 
       title= "Bowie's song durations") +
  theme( 
    axis.text.y = element_text(vjust=0.2, size=5),
    axis.ticks.x = element_blank()) +
  xlab('Song') + ylab('Normalized durations') +
  coord_flip()

TH_all$duration_z <- round((TH_all$track.duration_ms - mean(TH_all$track.duration_ms))/sd(TH_all$track.duration_ms), 2) 
TH_all$is_eno2 <- ifelse(TH_all$is_eno < 1, "No", "Yes")  # above / below avg flag
TH_all <- TH_all[order(TH_all$duration_z), ]
TH_all$track.name <- factor(TH_all$track.name, levels = TH_all$track.name)  # convert to factor to retain sorted order in plot.

divbar2 <- ggplot(TH_all, aes(x=track.name, y=duration_z)) + 
  geom_bar(stat='identity', aes(fill=is_eno2), width=.5)  +
  scale_fill_manual(name="Produced by Eno", 
                    labels = c("Produced by Eno", "Not Produced by Eno"), 
                    values = c("Yes"="#00ba38", "No"="#f8766d")) + 
  labs(subtitle="Normalised duration of TH's songs", 
       title= "Talking Heads's song durations") + 
  theme( 
    axis.text.y = element_text(vjust=0.2, size=5),
    axis.ticks.x = element_blank()) +
  xlab('Song') + ylab('Normalized durations') +
  coord_flip()

```
-----------------------------------------------------------------------

### Chordogram of crosseyed and painless


```{r}
circshift <- function(v, n) {
  if (n == 0) v else c(tail(v, n), head(v, -n))
}

#      C     C#    D     Eb    E     F     F#    G     Ab    A     Bb    B
major_chord <-
  c(   1,    0,    0,    0,    1,    0,    0,    1,    0,    0,    0,    0)
minor_chord <-
  c(   1,    0,    0,    1,    0,    0,    0,    1,    0,    0,    0,    0)
seventh_chord <-
  c(   1,    0,    0,    0,    1,    0,    0,    1,    0,    0,    1,    0)

major_key <-
  c(6.35, 2.23, 3.48, 2.33, 4.38, 4.09, 2.52, 5.19, 2.39, 3.66, 2.29, 2.88)
minor_key <-
  c(6.33, 2.68, 3.52, 5.38, 2.60, 3.53, 2.54, 4.75, 3.98, 2.69, 3.34, 3.17)

chord_templates <-
  tribble(
    ~name, ~template,
    "Gb:7", circshift(seventh_chord, 6),
    "Gb:maj", circshift(major_chord, 6),
    "Bb:min", circshift(minor_chord, 10),
    "Db:maj", circshift(major_chord, 1),
    "F:min", circshift(minor_chord, 5),
    "Ab:7", circshift(seventh_chord, 8),
    "Ab:maj", circshift(major_chord, 8),
    "C:min", circshift(minor_chord, 0),
    "Eb:7", circshift(seventh_chord, 3),
    "Eb:maj", circshift(major_chord, 3),
    "G:min", circshift(minor_chord, 7),
    "Bb:7", circshift(seventh_chord, 10),
    "Bb:maj", circshift(major_chord, 10),
    "D:min", circshift(minor_chord, 2),
    "F:7", circshift(seventh_chord, 5),
    "F:maj", circshift(major_chord, 5),
    "A:min", circshift(minor_chord, 9),
    "C:7", circshift(seventh_chord, 0),
    "C:maj", circshift(major_chord, 0),
    "E:min", circshift(minor_chord, 4),
    "G:7", circshift(seventh_chord, 7),
    "G:maj", circshift(major_chord, 7),
    "B:min", circshift(minor_chord, 11),
    "D:7", circshift(seventh_chord, 2),
    "D:maj", circshift(major_chord, 2),
    "F#:min", circshift(minor_chord, 6),
    "A:7", circshift(seventh_chord, 9),
    "A:maj", circshift(major_chord, 9),
    "C#:min", circshift(minor_chord, 1),
    "E:7", circshift(seventh_chord, 4),
    "E:maj", circshift(major_chord, 4),
    "G#:min", circshift(minor_chord, 8),
    "B:7", circshift(seventh_chord, 11),
    "B:maj", circshift(major_chord, 11),
    "D#:min", circshift(minor_chord, 3)
  )

key_templates <-
  tribble(
    ~name, ~template,
    "Gb:maj", circshift(major_key, 6),
    "Bb:min", circshift(minor_key, 10),
    "Db:maj", circshift(major_key, 1),
    "F:min", circshift(minor_key, 5),
    "Ab:maj", circshift(major_key, 8),
    "C:min", circshift(minor_key, 0),
    "Eb:maj", circshift(major_key, 3),
    "G:min", circshift(minor_key, 7),
    "Bb:maj", circshift(major_key, 10),
    "D:min", circshift(minor_key, 2),
    "F:maj", circshift(major_key, 5),
    "A:min", circshift(minor_key, 9),
    "C:maj", circshift(major_key, 0),
    "E:min", circshift(minor_key, 4),
    "G:maj", circshift(major_key, 7),
    "B:min", circshift(minor_key, 11),
    "D:maj", circshift(major_key, 2),
    "F#:min", circshift(minor_key, 6),
    "A:maj", circshift(major_key, 9),
    "C#:min", circshift(minor_key, 1),
    "E:maj", circshift(major_key, 4),
    "G#:min", circshift(minor_key, 8),
    "B:maj", circshift(major_key, 11),
    "D#:min", circshift(minor_key, 3)
  )

crosseyed <-
  get_tidy_audio_analysis("0yhwdmbgkKdE1plV8xWdrd") %>%
  compmus_align(bars, segments) %>%
  select(bars) %>%
  unnest(bars) %>%
  mutate(
    pitches =
      map(segments,
          compmus_summarise, pitches,
          method = "mean", norm = "manhattan"
      )
  )

crosseyed %>% 
  compmus_match_pitch_template(
    key_templates,         # Change to chord_templates if descired
    method = "euclidean",  # Try different distance metrics
    norm = "manhattan"     # Try different norms
  ) %>%
  ggplot(
    aes(x = start + duration / 2, width = duration, y = name, fill = d)
  ) +
  geom_tile() +
  scale_fill_viridis_c(guide = "none") +
  theme_minimal() +
  labs(x = "Time (s)", y = "")
```

***

This is a chordogram of the song 'Crosseyed and Painless' by Talking Heads. The song is built on repeating patterns and polyrythms and only uses a single chord. The chordogram shows this quite well, note the dark blue bar on the B:min row on the y-axis.

-----------------------------------------------------------------------


### "Eno trance": does Eno's love for repetition and creating an ambiance in his songs come up in his work with Bowie and Talking Heads?


```{r}
song1 <-
  ata %>%
  compmus_align(bars, segments) %>%
  select(bars) %>%
  unnest(bars) %>%
  mutate(
    pitches =
      map(segments,
          compmus_summarise, pitches,
          method = "rms", norm = "euclidean"
      )
  ) %>%
  mutate(
    timbre =
      map(segments,
          compmus_summarise, timbre,
          method = "rms", norm = "euclidean"
      )
  )


song2 <-
  fela %>%
  compmus_align(bars, segments) %>%
  select(bars) %>%
  unnest(bars) %>%
  mutate(
    pitches =
      map(segments,
          compmus_summarise, pitches,
          method = "rms", norm = "euclidean"
      )
  ) %>%
  mutate(
    timbre =
      map(segments,
          compmus_summarise, timbre,
          method = "rms", norm = "euclidean"
      )
  )

song3 <-
  heroes %>%
  compmus_align(bars, segments) %>%
  select(bars) %>%
  unnest(bars) %>%
  mutate(
    pitches =
      map(segments,
          compmus_summarise, pitches,
          method = "rms", norm = "euclidean"
      )
  ) %>%
  mutate(
    timbre =
      map(segments,
          compmus_summarise, timbre,
          method = "rms", norm = "euclidean"
      )
  )


```
```{r}

#ceptos
cepto0 <- song0 %>%
  compmus_gather_timbre() %>%
  ggplot(
    aes(
      x = start + duration / 2,
      width = duration,
      y = basis,
      fill = value
    )
  ) +
  geom_tile() +
  labs(title = "TH without Eno: New Feeling 1977",x = "Time (s)", y = NULL, fill = "Magnitude") +
  scale_fill_viridis_c() +                              
  theme_classic()

cepto1 <- song1 %>%
  compmus_gather_timbre() %>%
  ggplot(
    aes(
      x = start + duration / 2,
      width = duration,
      y = basis,
      fill = value
    )
  ) +
  geom_tile() +
  labs(title = "Bowie without Eno: Ashes to Ashes 1980",x = "Time (s)", y = NULL, fill = "Magnitude") +
  scale_fill_viridis_c() +                              
  theme_classic()

cepto2 <- song2 %>%
  compmus_gather_timbre() %>%
  ggplot(
    aes(
      x = start + duration / 2,
      width = duration,
      y = basis,
      fill = value
    )
  ) +
  geom_tile() +
  labs(title = "Talking Heads with Eno: Fela's Riff 1980",x = "Time (s)", y = NULL, fill = "Magnitude") +
  scale_fill_viridis_c() +                              
  theme_classic()

cepto3 <- song3 %>%
  compmus_gather_timbre() %>%
  ggplot(
    aes(
      x = start + duration / 2,
      width = duration,
      y = basis,
      fill = value
    )
  ) +
  geom_tile() +
  labs(title = "Bowie with Eno: Heroes 1977", x = "Time (s)", y = NULL, fill = "Magnitude") +
  scale_fill_viridis_c() +                              
  theme_classic()
```

```{r cepts, fig.width=30, fig.height=20}
grid.arrange(cepto0, cepto1, cepto2, cepto3, ncol=2)
```

***
Eno, as being one of the, if not the most influential pioneer of so called 'ambient' music, often tries to encapsulate the listener in a musical environment. With the release of 'Ambient 1: Music for airports', released in '78, the genre Ambient was basically formed and cemented. One of the key aspects of ambient music is that the songs do not follow the general verse and chorus structure and are more of a whole uniform piece where one part flows into the other without the listener noticing. By flowing from one part to another a breathing ambiance is created. With Eno so orbed by this genre during the late 70's, it is quite probable we can link some of his work with Bowie and Talking heads to Ambient music.

Clarification on the plots: First column: Talking Heads, second column: Bowie, first row: without Eno, second row with Eno.

The top two cepstograms show the timbre features in songs that make use of clear sections, we clearly see a pre-chorus in 'New Feeling at the c01 row around the 60 second mark. In 'Ashes to Ashes' we recognise different patterns too and see clear sections in the c01 and c02 rows.
Hewever, when looking at the bottom row we see a different pattern, namely one ('Heroes') or two ('Fela's Riff') thick stripes. These songs are very much like an ambient song in the sense that they are a whole piece in which no clear sections can be found. Heroes builds off of a repeating guitar backing track on which Bowie's vocal work creates the dynamics of the song, while 'Fela's Riff' is an instrumental song in which repeating and mesmerizing polyrythm's bring you into a trance, very much like Eno's ambient albums. These repeating patterns are found throughout the whole 'Remain in Light' album by Talking Heads.

I have not used the last three tracks on Bowie's 'Heroes' album, 'Sense of Doubt', 'Moss Garden' and 'Neuköln' because they are clearly Ambient songs on which Eno left his mark. The point of interest is to find aspects of ambient music in non-ambient music songs. 

### The fingerprints of Brian Eno in David Bowie's and The Talking Heads's work; an introduction to the corpus.


<b><font size="8em"> Introduction </font></b>
<font size="4em"> 


When thinking of a popular band or record, we mostly think about the charismatic lead singer, virtuous guitarist or energetic drummer. Overlooked however is often the role of the producer of the band. It is not without reason that George Martin is often called 'the fifth Beatle'. How much influence do producers have on a bands sound? How much does a record producers put their own style into the records they produce? Of course this will vary a lot from producer to producer, but for this Portfolio the work of one producer in particular will be highlighted: Brian Eno. Eno is regarded as one of the best producers in the history of record producers and has produced for names as Talking Heads, Roxy Music and U2. With fellow producer Tony Visconte he helped David Bowie create his famed 'Berlin Trilogy', existing of 'Low', 'Heroes' and 'Lodger', which this Portfolio will analyse and investigate. Next to Bowie's Berlin Trilogy we will look at another trilogy Eno has produced: Talking Heads's 'More songs about buildings and food', 'Fear of Music' and 'Remain in Light'. Can we find notable differences within Eno and non-Eno produced records? Are there correlations between his work with Bowie and Talking Heads?

</b>Corpus</b>

David Bowie's 'Berlin Trilogy' versus other work by Bowie ('Diamond Dogs', 'Hunky Dory', 'Let's Dance', 'Station to Station'). \n
Talking Heads 'More songs about buildings and food', 'Fear of Music' and 'Remain in Light' versus 'Talking Heads 77'', 'Speaking in Tongues' and 'Little Creatures'</font>




```{r}
tafel <- bowie[0:10, 6:16]
kbl(tafel, caption = "Some of the features of some of of Bowie's songs") %>% kable_styling(bootstrap_options = c("striped", "hover"))

```

***
Bowie
<iframe style="border-radius:12px" src="https://open.spotify.com/embed/playlist/109zncLRngc5ofl1DsCHcE?utm_source=generator" width="100%" height="380" frameBorder="0" allowfullscreen="" allow="autoplay; clipboard-write; encrypted-media; fullscreen; picture-in-picture"></iframe>

Berlin Trilogy
<iframe style="border-radius:12px" src="https://open.spotify.com/embed/playlist/6Rb67d7vVnq1FFAASwy5p5?utm_source=generator" width="100%" height="380" frameBorder="0" allowfullscreen="" allow="autoplay; clipboard-write; encrypted-media; fullscreen; picture-in-picture"></iframe>

Talking Heads
<iframe style="border-radius:12px" src="https://open.spotify.com/embed/playlist/4XrUACEdnQh8WfygAgSKxd?utm_source=generator" width="100%" height="380" frameBorder="0" allowfullscreen="" allow="autoplay; clipboard-write; encrypted-media; fullscreen; picture-in-picture"></iframe>

Talking Heads with Eno
<iframe style="border-radius:12px" src="https://open.spotify.com/embed/playlist/1K27mtJcCFQw4IxJLZlmNQ?utm_source=generator" width="100%" height="380" frameBorder="0" allowfullscreen="" allow="autoplay; clipboard-write; encrypted-media; fullscreen; picture-in-picture"></iframe>

### Did Bowie change anything else when switching languages for Heroes? A dynamic time warping analysis.
```{r}

heroes <-
  get_tidy_audio_analysis("5Ci3b8pfpLA9Zk17qGXBCF") %>%
  select(segments) %>%
  unnest(segments) %>%
  select(start, duration, pitches)

helden <-
  get_tidy_audio_analysis("7dCiqEHU97OX7mkRG1Kdjm") %>%
  select(segments) %>%
  unnest(segments) %>%
  select(start, duration, pitches)

compmus_long_distance(
  heroes %>% mutate(pitches = map(pitches, compmus_normalise, "manhattan")),
  helden %>% mutate(pitches = map(pitches, compmus_normalise, "manhattan")),
  feature = pitches,
  method = "manhattan"
) %>%
  ggplot(
    aes(
      x = xstart + xduration / 2,
      width = xduration,
      y = ystart + yduration / 2,
      height = yduration,
      fill = d
    )
  ) +
  geom_tile() +
  coord_equal() +
  labs(x = "Heroes", y = "Helden") +
  theme_minimal() +
  scale_fill_viridis_c(guide = NULL)

```


***
<font size="4em"> Here we see a dynamic time warping analysis of David Bowie's two versions of his song 'Heroes'. On the X-axis 'Heroes' is plotted, while on the Y-axis his German version 'Helden' is plotted. We see a clear correlation between the two, some small discrepancies could be formed due to there being a 3 second change in duration between the two songs. We can see that 'Helden' is a bit longer at the top of the graph! there is no overlap. \n  Since the two versions are found to be so similar, we won't take Bowie's German version into account in future analyses.</font>

-----------------------------------------------------------------------

### Does Eno affect the average duration of the albums he works on?

```{r, fig.width=20, fig.height=10}
grid.arrange(divbar1, divbar2, ncol=2)
```


***
<font size="4em"> As we can see from the graphs the duration is quite evenly distributed over songs produced by and not by Eno, I have chosen to use this diverging barplot because it can show each song individually, while the mean duration of the albums/songs would be influenced too much by tracks like 'Station to Station' and 'Television Man'</font>

-----------------------------------------------------------------------

### Is Bowie's most danceable album actually 'Let's Dance'?

```{r}
ggplotly(bowie_lollipop)
```

***
<font size="4em"> A little bit of a detour, but after I found out that of all albums in my corpus, Bowie's 'Let's Dance' has the highest mean danceability, I wanted to know how it ranked among all of his work. As we see that of all his albums it ranks at number 4, right after 'Tonight' and the two studio versions of 'Never Let Me'. It turns out the Japanese version of 'Never Let Me' is the grooviest of all, those lucky Japanese!</font>

-----------------------------------------------------------------------

### Does Eno make songs more sad?

```{r}
theme_set(theme_light())

bowieSum <- bowie%>%
  summarize(meanVal = mean(danceability)) %>% add_column(is_eno = 0, artist = 'bowie')
bowie_enoSum <- bowie_eno%>%
  summarize(meanVal = mean(danceability)) %>% add_column(is_eno = 1, artist = 'bowie')
THSum <- TH%>%
  summarize(meanVal = mean(danceability)) %>% add_column(is_eno = 0, artist = 'TH')
TH_enoSum <- TH_eno%>%
  summarize(meanVal = mean(danceability)) %>% add_column(is_eno = 1, artist = 'TH')
all_sum1 <- bind_rows(bowieSum, bowie_enoSum, THSum, TH_enoSum)

bowie_val <- subset(all_sum1, artist=="bowie" & is_eno=="0")$meanVal
bowie_eno_val <- subset(all_sum1, artist=="bowie" & is_eno=="1")$meanVal
TH_val <- subset(all_sum1, artist=="TH" & is_eno=="0")$meanVal
TH_eno_val <- subset(all_sum1, artist=="TH" & is_eno=="1")$meanVal

bowieval <- data.frame(artist = 'David Bowie', without_eno = bowie_val, with_eno = bowie_eno_val)
THval <- data.frame(artist = 'Talking Heads', without_eno = TH_val, with_eno = TH_eno_val)
all_sum <- bind_rows(bowieval, THval)

colnames(all_sum) <- c("artist", "without_eno", "with_eno")
left_label <- paste(all_sum$artist, round(all_sum$`without_eno`, digits = 2),sep=", ")
right_label <- paste(all_sum$artist, round(all_sum$`with_eno`, digits = 2),sep=", ")
all_sum$class <- ifelse((all_sum$`with_eno` - all_sum$`without_eno`) < 0, "red", "green")

plotDance <- ggplot(all_sum) + geom_segment(aes(x=1, xend=2, y=`without_eno`, yend=`with_eno`, col=class), size=.75, show.legend=F) + 
  geom_vline(xintercept=1, linetype="dashed", size=.1) + 
  geom_vline(xintercept=2, linetype="dashed", size=.1) +
  scale_color_manual(labels = c("Up", "Down"), 
                     values = c("green"="#00ba38", "red"="#f8766d")) +
  labs(x="", y="Mean danceability") +  # Axis labels
  xlim(.5, 2.5) + ylim(0.4,(1.1*(max(all_sum$`without_eno`, all_sum$`with_eno`))))

plotDance<- plotDance+ geom_text(label=left_label, y=all_sum$`without_eno`, x=rep(1, NROW(all_sum)), hjust=1.1, size=4)
plotDance<- plotDance+ geom_text(label=right_label, y=all_sum$`with_eno`, x=rep(2, NROW(all_sum)), hjust=-0.1, size=4)
plotDance<- plotDance+ geom_text(label="Without Eno", color='gray25', x=1, y=1.1*(max(all_sum$`without_eno`, all_sum$`with_eno`)), hjust=1.2, size=5)
plotDance<- plotDance+ geom_text(label="With Eno", color='gray25', x=2, y=1.1*(max(all_sum$`without_eno`, all_sum$`with_eno`)), hjust=-0.1, size=5)

plotDance<- plotDance+ theme(axis.ticks = element_blank(),
          axis.text.x = element_blank(),
          plot.margin = unit(c(1,2,1,2), "cm")) +
  labs(
    title = '1. The mean danceability of Eno vs. non-Eno produced albums'
  )

#####################################################################################################################################################
bowieSum <- bowie%>%
  summarize(meanVal = mean(valence)) %>% add_column(is_eno = 0, artist = 'bowie')
bowie_enoSum <- bowie_eno%>%
  summarize(meanVal = mean(valence)) %>% add_column(is_eno = 1, artist = 'bowie')
THSum <- TH%>%
  summarize(meanVal = mean(valence)) %>% add_column(is_eno = 0, artist = 'TH')
TH_enoSum <- TH_eno%>%
  summarize(meanVal = mean(valence)) %>% add_column(is_eno = 1, artist = 'TH')
all_sum1 <- bind_rows(bowieSum, bowie_enoSum, THSum, TH_enoSum)

bowie_val <- subset(all_sum1, artist=="bowie" & is_eno=="0")$meanVal
bowie_eno_val <- subset(all_sum1, artist=="bowie" & is_eno=="1")$meanVal
TH_val <- subset(all_sum1, artist=="TH" & is_eno=="0")$meanVal
TH_eno_val <- subset(all_sum1, artist=="TH" & is_eno=="1")$meanVal

bowieval <- data.frame(artist = 'David Bowie', without_eno = bowie_val, with_eno = bowie_eno_val)
THval <- data.frame(artist = 'Talking Heads', without_eno = TH_val, with_eno = TH_eno_val)
all_sum <- bind_rows(bowieval, THval)

colnames(all_sum) <- c("artist", "without_eno", "with_eno")
left_label <- paste(all_sum$artist, round(all_sum$`without_eno`, digits = 2),sep=", ")
right_label <- paste(all_sum$artist, round(all_sum$`with_eno`, digits = 2),sep=", ")
all_sum$class <- ifelse((all_sum$`with_eno` - all_sum$`without_eno`) < 0, "red", "green")

plotValence <- ggplot(all_sum) + geom_segment(aes(x=1, xend=2, y=`without_eno`, yend=`with_eno`, col=class), size=.75, show.legend=F) + 
  geom_vline(xintercept=1, linetype="dashed", size=.1) + 
  geom_vline(xintercept=2, linetype="dashed", size=.1) +
  scale_color_manual(labels = c("Up", "Down"), 
                     values = c("green"="#00ba38", "red"="#f8766d")) +
  labs(x="", y="Mean valence") +  # Axis labels
  xlim(.5, 2.5) + ylim(0.4,(1.1*(max(all_sum$`without_eno`, all_sum$`with_eno`))))

plotValence<- plotValence+ geom_text(label=left_label, y=all_sum$`without_eno`, x=rep(1, NROW(all_sum)), hjust=1.1, size=4)
plotValence<- plotValence+ geom_text(label=right_label, y=all_sum$`with_eno`, x=rep(2, NROW(all_sum)), hjust=-0.1, size=4)
plotValence<- plotValence+ geom_text(label="Without Eno", color='gray25', x=1, y=1.1*(max(all_sum$`without_eno`, all_sum$`with_eno`)), hjust=1.2, size=5) 
plotValence<- plotValence+ geom_text(label="With Eno", color='gray25', x=2, y=1.1*(max(all_sum$`without_eno`, all_sum$`with_eno`)), hjust=-0.1, size=5)

plotValence<- plotValence+ theme(axis.ticks = element_blank(),
          axis.text.x = element_blank(),
          plot.margin = unit(c(1,2,1,2), "cm")) +
  labs(
    title = '2. The mean valence of Eno vs. non-Eno produced albums'
  )


#####################################################################################################################################################
bowieSum <- bowie%>%
  summarize(meanVal = mean(tempo)) %>% add_column(is_eno = 0, artist = 'bowie')
bowie_enoSum <- bowie_eno%>%
  summarize(meanVal = mean(tempo)) %>% add_column(is_eno = 1, artist = 'bowie')
THSum <- TH%>%
  summarize(meanVal = mean(tempo)) %>% add_column(is_eno = 0, artist = 'TH')
TH_enoSum <- TH_eno%>%
  summarize(meanVal = mean(tempo)) %>% add_column(is_eno = 1, artist = 'TH')
all_sum1 <- bind_rows(bowieSum, bowie_enoSum, THSum, TH_enoSum)

bowie_val <- subset(all_sum1, artist=="bowie" & is_eno=="0")$meanVal
bowie_eno_val <- subset(all_sum1, artist=="bowie" & is_eno=="1")$meanVal
TH_val <- subset(all_sum1, artist=="TH" & is_eno=="0")$meanVal
TH_eno_val <- subset(all_sum1, artist=="TH" & is_eno=="1")$meanVal

bowieval <- data.frame(artist = 'David Bowie', without_eno = bowie_val, with_eno = bowie_eno_val)
THval <- data.frame(artist = 'Talking Heads', without_eno = TH_val, with_eno = TH_eno_val)
all_sum <- bind_rows(bowieval, THval)

colnames(all_sum) <- c("artist", "without_eno", "with_eno")
left_label <- paste(all_sum$artist, round(all_sum$`without_eno`),sep=", ")
right_label <- paste(all_sum$artist, round(all_sum$`with_eno`),sep=", ")
all_sum$class <- ifelse((all_sum$`with_eno` - all_sum$`without_eno`) < 0, "red", "green")

plotTempo <- ggplot(all_sum) + geom_segment(aes(x=1, xend=2, y=`without_eno`, yend=`with_eno`, col=class), size=.75, show.legend=F) + 
  geom_vline(xintercept=1, linetype="dashed", size=.1) + 
  geom_vline(xintercept=2, linetype="dashed", size=.1) +
  scale_color_manual(labels = c("Up", "Down"), 
                     values = c("green"="#00ba38", "red"="#f8766d")) +
  labs(x="", y="Mean Tempo") +  # Axis labels
  xlim(.5, 2.5) + ylim(105,(1.1*(max(all_sum$`without_eno`, all_sum$`with_eno`))))

plotTempo<- plotTempo+ geom_text(label=left_label, y=all_sum$`without_eno`, x=rep(1, NROW(all_sum)), hjust=1.1, size=4)
plotTempo<- plotTempo+ geom_text(label=right_label, y=all_sum$`with_eno`, x=rep(2, NROW(all_sum)), hjust=-0.1, size=4)
plotTempo<- plotTempo+ geom_text(label="Without Eno", color='gray25', x=1, y=1.1*(max(all_sum$`without_eno`, all_sum$`with_eno`)), hjust=1.2, size=5)  # title
plotTempo<- plotTempo+ geom_text(label="With Eno", color='gray25', x=2, y=1.1*(max(all_sum$`without_eno`, all_sum$`with_eno`)), hjust=-0.1, size=5)  # title

plotTempo<- plotTempo+ theme(axis.ticks = element_blank(),
          axis.text.x = element_blank(),
          plot.margin = unit(c(1,2,1,2), "cm")) +
  labs(
    title = '3. The mean tempo of Eno vs. non-Eno produced albums'
  )


#####################################################################################################################################################
bowieSum <- bowie%>%
  summarize(meanVal = mean(energy)) %>% add_column(is_eno = 0, artist = 'bowie')
bowie_enoSum <- bowie_eno%>%
  summarize(meanVal = mean(energy)) %>% add_column(is_eno = 1, artist = 'bowie')
THSum <- TH%>%
  summarize(meanVal = mean(energy)) %>% add_column(is_eno = 0, artist = 'TH')
TH_enoSum <- TH_eno%>%
  summarize(meanVal = mean(energy)) %>% add_column(is_eno = 1, artist = 'TH')
all_sum1 <- bind_rows(bowieSum, bowie_enoSum, THSum, TH_enoSum)

bowie_val <- subset(all_sum1, artist=="bowie" & is_eno=="0")$meanVal
bowie_eno_val <- subset(all_sum1, artist=="bowie" & is_eno=="1")$meanVal
TH_val <- subset(all_sum1, artist=="TH" & is_eno=="0")$meanVal
TH_eno_val <- subset(all_sum1, artist=="TH" & is_eno=="1")$meanVal

bowieval <- data.frame(artist = 'David Bowie', without_eno = bowie_val, with_eno = bowie_eno_val)
THval <- data.frame(artist = 'Talking Heads', without_eno = TH_val, with_eno = TH_eno_val)
all_sum <- bind_rows(bowieval, THval)

colnames(all_sum) <- c("artist", "without_eno", "with_eno")
left_label <- paste(all_sum$artist, round(all_sum$`without_eno`, digits = 2),sep=", ")
right_label <- paste(all_sum$artist, round(all_sum$`with_eno`, digits = 2), sep=", ")
all_sum$class <- ifelse((all_sum$`with_eno` - all_sum$`without_eno`) < 0, "red", "green")

plotEnergy <- ggplot(all_sum) + geom_segment(aes(x=1, xend=2, y=`without_eno`, yend=`with_eno`, col=class), size=.75, show.legend=F) + 
  geom_vline(xintercept=1, linetype="dashed", size=.1) + 
  geom_vline(xintercept=2, linetype="dashed", size=.1) +
  scale_color_manual(labels = c("Up", "Down"), 
                     values = c("green"="#00ba38", "red"="#f8766d")) +
  labs(x="", y="Mean Energy") +  # Axis labels
  xlim(.5, 2.5) + ylim(0.4,(1.1*(max(all_sum$`without_eno`, all_sum$`with_eno`))))

plotEnergy<- plotEnergy+ geom_text(label=left_label, y=all_sum$`without_eno`, x=rep(1, NROW(all_sum)), hjust=1.1, size=4)
plotEnergy<- plotEnergy+ geom_text(label=right_label, y=all_sum$`with_eno`, x=rep(2, NROW(all_sum)), hjust=-0.1, size=4)
plotEnergy<- plotEnergy+ geom_text(label="Without Eno", color='gray25', x=1, y=1.1*(max(all_sum$`without_eno`, all_sum$`with_eno`)), hjust=1.2, size=5)  # title
plotEnergy<- plotEnergy+ geom_text(label="With Eno", color='gray25', x=2, y=1.1*(max(all_sum$`without_eno`, all_sum$`with_eno`)), hjust=-0.1, size=5)  # title

plotEnergy<- plotEnergy+ theme(axis.ticks = element_blank(),
          axis.text.x = element_blank(),
          plot.margin = unit(c(1,2,1,2), "cm")) +
  labs(
    title = '4. The mean energy of Eno vs. non-Eno produced albums'
  )

```

```{r, fig.width=20, fig.height=10}
grid.arrange(plotDance, plotValence, plotTempo, plotEnergy, ncol=2)

```

***
<font size="4em"> After finding out that Let's Dance is, who would've thought, very danceable I wanted to know what applying a whiff of Eno to your production does for the average danceability, and related attributes of your album.\n

In the top left we can see a drop in danceability in the albums which Eno has produced compared to the ones he hasn't. It also turns out that the average valence decreases. Does that mean that the albums on which Eno has worked are slower and contain less energy? No! As we see in graphs 3 and four, the mean Tempo and mean energy do not decrease in Eno's albums, they increase if anything.

What attributes lowers the average danceability and valence if it's not the tempo or the energy?
</font>

### Conclusion/Discussion
<b><font size="8em"> Conclusion </font></b>

To be written!